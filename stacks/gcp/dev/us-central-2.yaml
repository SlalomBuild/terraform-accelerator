---
import:
  - gcp/dev/_defaults
  - gcp/dev/globals

vars:
  label_key_case: "lower"
  label_value_case: "lower"
  enabled: true
  region: "us-central2"
  environment: "dev"
  namespace: "accelerator-dev"
  stage: "uc2"

components:
  terraform:
    vpc:
      metadata:
        component: gcp/net-vpc
      vars:
        name: vpc
        auto_create_subnetworks: false
        subnets:
        - name: "subnet-1"
          
          ip_cidr_range: "10.1.0.0/16"
          secondary_ip_ranges:
            -
              range_name: "pods-1" 
              ip_cidr_range: "172.16.1.0/24"
              
            -
              range_name: "services-1"
              ip_cidr_range: "192.168.1.0/24"
        - name: "subnet-2"
          
          ip_cidr_range: "10.2.0.0/16"
          secondary_ip_ranges:
            -
              range_name: "pods-2" 
              ip_cidr_range: "172.16.2.0/24"
              
            -  range_name: "services-2"
               ip_cidr_range: "192.168.2.0/24"

    network:
      metadata:
        component: gcp/network
      vars:
        routing_mode: "GLOBAL"
        subnets:
        - subnet_name: "subnet-1"
          
          cidr: "10.1.0.0/16"
          private_google_access: true
          secondary_cidrs:
          - name: "pods-1" 
            range: "172.16.1.0/24"
              
          - name: "services-1"
            range: "192.168.1.0/24"
          flow_logs:
            aggregation_interval: "INTERVAL_5_SEC"
            flow_sampling: "0.5"
            metadata: "INCLUDE_ALL_METADATA"
          
        - subnet_name: "subnet-2"
          
          cidr: "10.2.0.0/16"
          secondary_cidrs:
          - name: "pods-2" 
            range: "172.16.2.0/24"
              
          - name: "services-2"
            range: "192.168.2.0/24"

        routes:
        - name: "egress-internet"
          destination_range: "0.0.0.0/0"
          tags: "egress-inet"
          next_hop_internet: "true"

        cloud_nat:
          subnetworks:
          - name: "subnet-1"
            source_ip_ranges_to_nat:
            - "ALL_IP_RANGES"
          
          - name: "subnet-2"
            source_ip_ranges_to_nat:
            - "10.2.0.0/16"
            - "172.16.2.0/24"
            - "192.168.2.0/24"
        shared_vpc_host: false
        service_project_names: []
        firewall_rules: []
        peers: []
        private_connections: []
        attributes: []
    
    gcs-bucket:
      metadata:
        component: gcp/gcs-bucket
      vars:
        attributes: []
        kms_encryption_enabled: false
        gcs_bucket: {}
        kms: {}
        bucket_iam: []
        tags: {}
        
      